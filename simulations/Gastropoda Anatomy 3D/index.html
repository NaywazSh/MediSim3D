<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gastropoda 3D Anatomy</title>
    <style>
        :root {
            --snail-shell: #8d6e63;
            --snail-flesh: #e0d4b0;
            --ui-accent: #4e342e;
            --panel-bg: rgba(255, 255, 255, 0.9);
        }
        body { 
            margin: 0; 
            overflow: hidden; 
            background: radial-gradient(circle at center, #ffffff 0%, #e0f2f1 100%); 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            color: #333; 
        }
        
        #header {
            position: absolute;
            top: 30px;
            left: 30px;
            z-index: 10;
            pointer-events: none;
        }

        .glass-panel {
            background: var(--panel-bg);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            border-left: 6px solid var(--snail-shell);
            pointer-events: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 320px;
        }

        h1 { margin: 0; font-size: 1.4rem; color: var(--ui-accent); text-transform: uppercase; letter-spacing: 1px; }
        .sci-name { font-style: italic; font-size: 0.9rem; opacity: 0.9; margin-bottom: 12px; display: block; color: #6d4c41; font-weight: bold; }

        #data-panel {
            position: absolute;
            top: 30px;
            right: 30px;
            width: 280px;
            background: var(--panel-bg);
            backdrop-filter: blur(15px);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.05);
            display: none;
            pointer-events: none;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        #controls {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            font-weight: bold;
            color: #4e342e;
            letter-spacing: 1px;
            text-transform: uppercase;
            background: rgba(255,255,255,0.7);
            padding: 8px 25px;
            border-radius: 30px;
        }

        .anatomy-title {
            color: var(--ui-accent);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 8px;
            display: block;
            border-bottom: 2px solid #8d6e63;
            padding-bottom: 4px;
        }
    </style>
</head>
<body>

    <div id="header">
        <div class="glass-panel">
            <h1>Gastropoda</h1>
            <span class="sci-name">Class: Gastropoda | Phylum: Mollusca</span>
            <p style="font-size: 0.85rem; line-height: 1.5; margin: 0; color: #444;">
                Characterized by <strong>torsion</strong> (visceral mass twisting) and a single, 
                usually spiraled shell. They move via pedal waves of the muscular foot.
            </p>
        </div>
    </div>

    <div id="data-panel">
        <span id="part-title" class="anatomy-title">Part Name</span>
        <p id="part-desc" style="font-size: 0.9rem; margin: 0; line-height: 1.6; color: #444;">Description...</p>
    </div>

    <div id="controls">Orbit: Drag • Zoom: Scroll • Inspect: Hover over parts</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        let scene, camera, renderer, controls, raycaster, mouse;
        let shell, body, foot, tentacles = [];
        let INTERSECTED;

        const anatomyData = {
            'Spiraled Shell': 'A calcareous exoskeleton that protects the visceral mass. It grows in a logarithmic spiral.',
            'Apex': 'The oldest tip of the shell from which growth begins.',
            'Muscular Foot': 'The ventral surface used for creeping locomotion via waves of muscular contraction.',
            'Ocular Tentacles': 'The longer upper pair of tentacles carrying eyes at their tips, capable of retraction.',
            'Sensory Tentacles': 'The shorter lower pair used primarily for chemoreception (smell/taste).',
            'Visceral Mass': 'Contained within the shell, housing the digestive, excretory, and reproductive organs.',
            'Mantle': 'The tissue that secretes the shell and forms the respiratory mantle cavity.',
            'Pneumostome': 'The respiratory opening on the right side of the mantle used for breathing air.'
        };

        function init() {
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0xe0f2f1, 0.015);

            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(10, 8, 15);

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.body.appendChild(renderer.domElement);

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;

            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            // Lighting
            scene.add(new THREE.AmbientLight(0xffffff, 0.7));
            const pointLight = new THREE.PointLight(0xffffff, 0.8);
            pointLight.position.set(10, 15, 10);
            scene.add(pointLight);

            createSnail();
            window.addEventListener('resize', onWindowResize);
            window.addEventListener('mousemove', onMouseMove);
            
            animate();
        }

        function createSnail() {
            // 1. The Shell (Created using a series of Toruses to simulate a spiral)
            shell = new THREE.Group();
            const shellMat = new THREE.MeshPhongMaterial({ color: 0x8d6e63, shininess: 40 });
            
            for (let i = 0; i < 20; i++) {
                const r = 3 * Math.pow(0.85, i);
                const tube = 1.2 * Math.pow(0.85, i);
                const torusGeo = new THREE.TorusGeometry(r, tube, 16, 32);
                const ring = new THREE.Mesh(torusGeo, shellMat);
                ring.rotation.x = Math.PI / 2;
                ring.position.y = i * 0.35;
                ring.rotation.z = i * 0.5;
                ring.userData.name = i === 19 ? 'Apex' : 'Spiraled Shell';
                shell.add(ring);
            }
            shell.position.set(0, 2, 0);
            scene.add(shell);

            // 2. The Body (Flesh)
            const bodyGroup = new THREE.Group();
            const fleshMat = new THREE.MeshPhongMaterial({ 
                color: 0xe0d4b0, 
                shininess: 10,
                transparent: true,
                opacity: 0.95
            });

            // Main head/neck
            const headGeo = new THREE.CylinderGeometry(1.2, 1.5, 5, 20);
            const head = new THREE.Mesh(headGeo, fleshMat);
            head.rotation.z = Math.PI / 2.5;
            head.position.set(4, 1.5, 0);
            head.userData.name = 'Mantle';
            bodyGroup.add(head);

            // The Foot
            const footGeo = new THREE.BoxGeometry(10, 0.8, 3, 20, 1, 5);
            foot = new THREE.Mesh(footGeo, fleshMat);
            foot.position.set(1, 0, 0);
            foot.userData.name = 'Muscular Foot';
            bodyGroup.add(foot);

            // Tentacles
            const tentacleGeo = new THREE.CylinderGeometry(0.1, 0.2, 3, 8);
            
            // Ocular Tentacles (Upper)
            const otL = new THREE.Mesh(tentacleGeo, fleshMat);
            otL.position.set(6, 3.5, 0.8);
            otL.rotation.z = -Math.PI/4;
            otL.userData.name = 'Ocular Tentacles';
            
            const otR = otL.clone();
            otR.position.z = -0.8;
            
            // Eyes (small black spheres)
            const eyeGeo = new THREE.SphereGeometry(0.15, 8, 8);
            const eyeMat = new THREE.MeshBasicMaterial({color: 0x000000});
            const eyeL = new THREE.Mesh(eyeGeo, eyeMat);
            eyeL.position.y = 1.5;
            otL.add(eyeL);
            const eyeR = eyeL.clone();
            otR.add(eyeR);

            tentacles.push(otL, otR);
            bodyGroup.add(otL, otR);

            scene.add(bodyGroup);
            body = bodyGroup;
        }

        function onMouseMove(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            const time = performance.now() * 0.001;

            // 1. Pedal Waves (Locomotion)
            const footVertices = foot.geometry.attributes.position;
            for (let i = 0; i < footVertices.count; i++) {
                const x = footVertices.getX(i);
                // Create a wave that travels along the X axis
                const wave = Math.sin(time * 3 + x * 1.5) * 0.15;
                if (footVertices.getY(i) < 0) { // Only affect the bottom of the foot
                    footVertices.setY(i, -0.4 + wave);
                }
            }
            foot.geometry.attributes.position.needsUpdate = true;

            // 2. Tentacle "Searching" Movement
            tentacles.forEach((t, i) => {
                t.rotation.x = Math.sin(time + i) * 0.2;
                t.scale.y = 0.8 + Math.sin(time * 0.5 + i) * 0.3;
            });

            // 3. Subtle shell bobbing
            shell.position.y = 2 + Math.sin(time * 0.5) * 0.1;

            // Raycasting
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(scene.children, true);
            const info = document.getElementById('data-panel');

            if (intersects.length > 0) {
                let target = intersects[0].object;
                while (target && !target.userData.name && target.parent) target = target.parent;
                
                const name = target.userData.name;
                if (name && anatomyData[name]) {
                    info.style.display = 'block';
                    document.getElementById('part-title').innerText = name;
                    document.getElementById('part-desc').innerText = anatomyData[name];
                    INTERSECTED = target;
                }
            } else {
                info.style.display = 'none';
                INTERSECTED = null;
            }

            controls.update();
            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>
